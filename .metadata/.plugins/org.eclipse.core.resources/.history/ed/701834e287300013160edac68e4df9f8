package com.example.taskmon;

import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.InputStreamReader;

import com.jjoe64.graphview.GraphViewSeries;
import com.jjoe64.graphview.GraphView.GraphViewData;
import android.os.Handler;


public class Observer implements Runnable {

	private int pid;
	private long t;
	private Runnable mTimer;
	private Handler handler;
	private long period;
	private GraphViewSeries dataSeries;
	
	public Observer(int pid, long t){
		this.pid = pid;
		
	}

	public void run(){

		mTimer = new Runnable() {
			@Override
			public void run() {
				String filename = "/sys/rtes/tasks/"+pid+"/util";
				String data = null;
				try{
				BufferedReader brn = new BufferedReader(new InputStreamReader(
						new FileInputStream(filename)));
				data = brn.readLine();
				
				}catch(Exception e){
					e.printStackTrace();
				}
				if(!data.equals(null)){
						double dataPoint = Double.parseDouble(data);

					dataSeries.appendData(new GraphViewData(System.currentTimeMillis()
							,dataPoint), true, 100);
					handler.postDelayed(this, period);
				}
			}
		};
		handler.postDelayed(mTimer, 1000);

	}
}
